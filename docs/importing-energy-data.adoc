= Importing Energy Data
:toc: left
:icons: font

This guide explains how to prepare and import your energy data into the Battery Forecast app. It also shows what the file should look like and how to fix common issues.

== What you need

You can import two files for one calendar year:

- Consumption (energy taken from the grid)
- Feed-in (energy sent to the grid)

Both files use the same structure. Importing both is recommended for best accuracy, but you can also import only consumption if you do not feed in.

== File format overview

- File type: Text/CSV
- Default column separator: semicolon (;)
- Header line: supported (default expectation) but not required
- Required columns:
  - Timestamp column (date and time)
  - Power/Energy column (kWh for the interval)
- Timestamp format: dd.MM.yyyy HH:mm (e.g., 31.12.2024 23:59)
- Decimal separators: both comma (5,3) and dot (5.3) are supported
- Thousands separators: supported (e.g., 1.234,56 or 1,234.56)

TIP: The default settings match the Smart Meter CSV export from NÖ Netz GmbH. If your file uses a different separator or column order, see Advanced configuration below.

== Minimal example (with header)

Example consumption or feed-in CSV snippet using the default settings:

----
Messzeitpunkt;Verbrauch (kWh)
31.12.2024 23:59;5,3
01.01.2025 00:00;4,7
----

- Column 1: Messzeitpunkt = timestamp (dd.MM.yyyy HH:mm)
- Column 2: Verbrauch (kWh) = energy amount for the interval

== Minimal example (without header)

If your file has no header line, it can still be imported. The parser expects data from the first line in that case.

----
31.12.2024 23:59;5,3
01.01.2025 00:00;4,7
----

== Advanced configuration (column order and separator)

Some CSV exports use a different column order or a different separator. The importer can be configured accordingly. The following example shows a custom layout where the power value is in column 2 and the timestamp is in column 3, and the data lines use a vertical bar (|) as separator:

----
col1;Messzeitpunkt;Verbrauch (kWh);last col
x;5,3;31.12.2024 23:59;y
a;4,7;01.01.2025 00:00;b
----

Or with a custom separator in data lines:

----
Messzeitpunkt;Verbrauch (kWh)
31.12.2024 23:59|5,3
01.01.2025 00:00|4,7
----

In the app’s import screen, you can adjust:

- Column separator (e.g., ; , | , ,)
- Which column contains the timestamp
- Which column contains the power/energy value
- Whether the first line is a header

== Step-by-step: Import in the app

1. Open the web app: https://meks77.github.io/battery-forecast/
2. Click Import in the navigation.
3. Choose the file type to import (Consumption or Feed-in).
4. Upload the corresponding CSV file.
5. If your file differs from the default format, adjust the separator, column indices, and header setting.
6. Check the preview to ensure the values look correct.
7. Repeat for the second file (if available).
8. Continue to the calculation screen.

== Common errors and how to fix them

- Timestamp parsing error (Couldn’t parse … as timestamp)
  - Ensure the format is dd.MM.yyyy HH:mm (e.g., 01.01.2025 00:00)
  - Remove extra spaces around the timestamp
  - Verify the correct column is selected as the timestamp column

- Power value format error (Couldn’t parse power value …)
  - Use numeric values only (examples: 5,3 or 5.3)
  - Avoid percent signs or other symbols (e.g., 5%5 is invalid)
  - If your numbers have thousands separators, they are supported (e.g., 1.234,56)
  - Verify the correct column is selected as the power/energy column

- Column index out of range
  - Adjust the column indices to valid positions present in the file

- Empty or header-only file
  - The importer will accept it but there will be 0 rows to import. Provide a file with data lines.

== Notes on units and aggregation

- The power/energy column represents energy for the interval in kWh (as exported by typical smart meter CSVs).
- The app aggregates your original data for the analysis period and uses it together with your battery and tariff settings to compute savings and statistics.

== Where to get your data

- NÖ Netz GmbH Smart Meter portal: Export your consumption and feed-in data as CSV for the desired year. The default importer settings are designed for this export format.

If your provider’s CSV differs, use the Advanced configuration during import to adapt column order and separator.
